(window.webpackJsonp=window.webpackJsonp||[]).push([[82],{189:function(t,e,r){"use strict";r.r(e);var s=r(0),a=Object(s.a)({},function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"content"},[t._m(0),t._v(" "),r("ul",[r("li",[t._v("alpine linux 是一个基于安全的轻量级 Linux 发行版，基于 musl libc 和 busybox。alpine linux 由于简单安全，非常适合 docker 的 linux 发行版，并且被 docker 官方所推荐用来取代 ubuntu。它不但非常小，仅有 5m 左右，而且经过优化可以在 RAM 中运行")]),t._v(" "),r("li",[t._v("既然这么省资源，那么本文就尝试在虚拟机中安装 alpine，然后安装 docker")]),t._v(" "),r("li",[r("a",{attrs:{href:"https://wiki.alpinelinux.org/wiki/Main_Page",target:"_blank",rel:"noopener noreferrer"}},[t._v("官方文档"),r("OutboundLink")],1)])]),t._v(" "),t._m(1),t._v(" "),r("ul",[t._m(2),t._v(" "),r("li",[r("a",{attrs:{href:"http://dl-cdn.alpinelinux.org/alpine/v3.9/releases/x86_64/alpine-virt-3.9.4-x86_64.iso",target:"_blank",rel:"noopener noreferrer"}},[t._v("下载地址链接"),r("OutboundLink")],1)]),t._v(" "),t._m(3)]),t._v(" "),t._m(4),t._v(" "),t._m(5),t._v(" "),t._m(6),t._v(" "),r("ul",[r("li",[t._v("启动之后进入安装步骤")]),t._v(" "),r("li",[t._v("具体步骤参考 https://wiki.alpinelinux.org/wiki/Install_to_disk")]),t._v(" "),r("li",[t._v("可参考博客："),r("a",{attrs:{href:"https://blog.csdn.net/csdn_duomaomao/article/details/76053229",target:"_blank",rel:"noopener noreferrer"}},[t._v("Alpine linux 硬盘安装"),r("OutboundLink")],1),t._v("、"),r("a",{attrs:{href:"https://blog.csdn.net/ochinchina_cn/article/details/58593271",target:"_blank",rel:"noopener noreferrer"}},[t._v("alpine linux docker 安装体验"),r("OutboundLink")],1)])]),t._v(" "),t._m(7),t._v(" "),r("ul",[r("li",[t._v("Alpine Linux 的软件包是经过数字签名的 tar.gz 存档，包含程序，配置文件和依赖关系元数据。它们具有扩展名.apk，通常称为“a-packs”。包存储在一个或多个存储库中。")]),t._v(" "),r("li",[t._v("相关文档，包含常用命令及介绍。https://wiki.alpinelinux.org/wiki/Alpine_Linux_package_management")]),t._v(" "),r("li",[r("a",{attrs:{href:"https://pkgs.alpinelinux.org/packages",target:"_blank",rel:"noopener noreferrer"}},[t._v("包搜索地址"),r("OutboundLink")],1)]),t._v(" "),r("li",[t._v("有些包可能在社区的源才有，地址：http://dl-cdn.alpinelinux.org/alpine/latest-stable/community")])]),t._v(" "),t._m(8),t._v(" "),r("ul",[t._m(9),t._v(" "),t._m(10),t._v(" "),t._m(11),t._v(" "),t._m(12),t._v(" "),t._m(13),t._v(" "),r("li",[t._v("参考"),r("a",{attrs:{href:"https://wiki.alpinelinux.org/wiki/Docker",target:"_blank",rel:"noopener noreferrer"}},[t._v("alpinelinux Docker"),r("OutboundLink")],1)])]),t._v(" "),t._m(14),t._v(" "),t._m(15),t._v(" "),t._m(16),t._m(17),t._v(" "),t._m(18),t._v(" "),t._m(19),t._m(20),t._v(" "),t._m(21),t._m(22),t._v(" "),t._m(23),t._m(24),t._v(" "),t._m(25),t._v(" "),t._m(26),t._v(" "),t._m(27),t._v(" "),t._m(28),t._v(" "),t._m(29)])},[function(){var t=this.$createElement,e=this._self._c||t;return e("h1",{attrs:{id:"alpine-环境中安装-docker"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#alpine-环境中安装-docker","aria-hidden":"true"}},[this._v("#")]),this._v(" alpine 环境中安装 docker")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"下载"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#下载","aria-hidden":"true"}},[this._v("#")]),this._v(" 下载")])},function(){var t=this.$createElement,e=this._self._c||t;return e("li",[this._v("alpinelinux"),e("code",[this._v("https://www.alpinelinux.org/downloads/")]),this._v("，这里选择"),e("code",[this._v("VIRTUAL")]),this._v("，它与标准版相似、瘦下来的内核、针对虚拟系统进行了优化。")])},function(){var t=this.$createElement,e=this._self._c||t;return e("li",[this._v("下载得到的文件是"),e("code",[this._v("alpine-virt-3.9.4-x86_64.iso")]),this._v("，大小 35m")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"vmware-中安装"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#vmware-中安装","aria-hidden":"true"}},[this._v("#")]),this._v(" VMware 中安装")])},function(){var t=this.$createElement,e=this._self._c||t;return e("ul",[e("li",[this._v("按道理 VirtualBox 也是一样的，VMware 的新建虚拟机的设置中，操作系统类型选择"),e("code",[this._v("Linux")]),this._v("，版本选择"),e("code",[this._v("其他Linux 4.x 或更高版本内核 64 位")])]),this._v(" "),e("li",[this._v("其他步骤按照提示来就行了，问题不大。新建完后启动虚拟机")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"设置-alpine"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#设置-alpine","aria-hidden":"true"}},[this._v("#")]),this._v(" 设置 alpine")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"apk-介绍"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#apk-介绍","aria-hidden":"true"}},[this._v("#")]),this._v(" apk 介绍")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"安装-docker"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#安装-docker","aria-hidden":"true"}},[this._v("#")]),this._v(" 安装 docker")])},function(){var t=this.$createElement,e=this._self._c||t;return e("li",[this._v("Docker 包位于“社区”存储库中，因此如果 apk 添加失败且具有不可满足的约束，则需要编辑"),e("code",[this._v("/etc/apk/repositories")]),this._v("文件以添加（或取消注释）一行，如：http://dl-cdn.alpinelinux.org/alpine/latest-stable/community")])},function(){var t=this.$createElement,e=this._self._c||t;return e("li",[this._v("更新索引存储库"),e("code",[this._v("apk update")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("li",[this._v("开始安装"),e("code",[this._v("apk add docker")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("li",[this._v("要在引导时启动 Docker 守护程序，请运行："),e("code",[this._v("rc-update add docker boot")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("li",[this._v("然后手动启动 Docker 守护程序，运行："),e("code",[this._v("service docker start")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"运行"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#运行","aria-hidden":"true"}},[this._v("#")]),this._v(" 运行")])},function(){var t=this.$createElement,e=this._self._c||t;return e("ul",[e("li",[this._v("启动"),e("code",[this._v("service docker start")])]),this._v(" "),e("li",[e("code",[this._v("docker run hello-word")])])])},function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"language-bash extra-class"},[r("pre",{pre:!0,attrs:{class:"language-bash"}},[r("code",[t._v("localhost:/etc/docker"),r("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# docker run hello-world")]),t._v("\nUnable to "),r("span",{pre:!0,attrs:{class:"token function"}},[t._v("find")]),t._v(" image "),r("span",{pre:!0,attrs:{class:"token string"}},[t._v("'hello-world:latest'")]),t._v(" locally\nlatest: Pulling from library/hello-world\n1b930d010525: Pull complete\nDigest: sha256:0e11c388b664df8a27a901dce21eb89f11d8292f7fca1b3e3c4321bf7897bffe\nStatus: Downloaded newer image "),r("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" hello-world:latest\n\nHello from Docker"),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("\nThis message shows that your installation appears to be working correctly.\n\nTo generate this message, Docker took the following steps:\n 1. The Docker client contacted the Docker daemon.\n 2. The Docker daemon pulled the "),r("span",{pre:!0,attrs:{class:"token string"}},[t._v('"hello-world"')]),t._v(" image from the Docker Hub.\n    "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("amd64"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n 3. The Docker daemon created a new container from that image "),r("span",{pre:!0,attrs:{class:"token function"}},[t._v("which")]),t._v(" runs the\n    executable that produces the output you are currently reading.\n 4. The Docker daemon streamed that output to the Docker client, "),r("span",{pre:!0,attrs:{class:"token function"}},[t._v("which")]),t._v(" sent it\n    to your terminal.\n\nTo try something "),r("span",{pre:!0,attrs:{class:"token function"}},[t._v("more")]),t._v(" ambitious, you can run an Ubuntu container with:\n $ docker run -it ubuntu "),r("span",{pre:!0,attrs:{class:"token function"}},[t._v("bash")]),t._v("\n\nShare images, automate workflows, and "),r("span",{pre:!0,attrs:{class:"token function"}},[t._v("more")]),t._v(" with a "),r("span",{pre:!0,attrs:{class:"token function"}},[t._v("free")]),t._v(" Docker ID:\n https://hub.docker.com/\n\nFor "),r("span",{pre:!0,attrs:{class:"token function"}},[t._v("more")]),t._v(" examples and ideas, visit:\n https://docs.docker.com/get-started/\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"问题"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#问题","aria-hidden":"true"}},[this._v("#")]),this._v(" 问题")])},function(){var t=this.$createElement,e=this._self._c||t;return e("ul",[e("li",[this._v("上面安装完 docker 之后，使用命令"),e("code",[this._v("docker -v")]),this._v("可查看版本，但是容器相关命令出错")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[this._v("localhost:~"),e("span",{pre:!0,attrs:{class:"token comment"}},[this._v("# docker ps")]),this._v("\nCannot connect to the Docker daemon at unix:///var/rundocker.sock. Is   the docker daemon running?\n")])])])},function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("ul",[r("li",[t._v("通过命令"),r("code",[t._v("service docker start")]),t._v("也启动 docker，`/var/run/docker.sock 也确实存在。")]),t._v(" "),r("li",[t._v("折腾一番之后，查看日志"),r("code",[t._v("cat ./var/log/docker.log")]),t._v("，得到关键信息"),r("code",[t._v("Error starting daemon: Devices cgroup isn't mounted")]),t._v("。")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[this._v("cat")]),this._v(" ./var/log/docker.log\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("ul",[e("li",[this._v("最后看了官方文档得以解决，https://wiki.alpinelinux.org/wiki/Docker")]),this._v(" "),e("li",[this._v("关键点还是"),e("code",[this._v("cgroup filesystem")]),this._v("的问题，"),e("code",[this._v("cgroup")]),this._v("是什么请自行查询")])])},function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"language-bash extra-class"},[r("pre",{pre:!0,attrs:{class:"language-bash"}},[r("code",[t._v("localhost:/etc/docker"),r("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# rc-update add docker boot")]),t._v("\n * "),r("span",{pre:!0,attrs:{class:"token function"}},[t._v("service")]),t._v(" docker added to runlevel boot\nlocalhost:/etc/docker"),r("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# service docker start")]),t._v("\n * Mounting cgroup filesystem "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\n * Starting docker "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("ul",[e("li",[this._v("所以整个问题的根源是"),e("code",[this._v("cgroup filesystem")]),this._v("没有挂载，在执行"),e("code",[this._v("rc-update add docker boot")]),this._v("后在启动就好了")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"其他使用"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#其他使用","aria-hidden":"true"}},[this._v("#")]),this._v(" 其他使用")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"执行脚本"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#执行脚本","aria-hidden":"true"}},[this._v("#")]),this._v(" 执行脚本")])},function(){var t=this.$createElement,e=this._self._c||t;return e("ul",[e("li",[this._v("sh执行/bin/busybox，执行脚本不支持括号方式的数组，因此需要bash，其他解决办法暂不知晓")]),this._v(" "),e("li",[this._v("执行查看"),e("code",[this._v("ls -l /bin/*sh")]),this._v("，没有bash的话，执行"),e("code",[this._v("apk add bash")]),this._v("安装")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"总结"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#总结","aria-hidden":"true"}},[this._v("#")]),this._v(" 总结")])},function(){var t=this.$createElement,e=this._self._c||t;return e("ul",[e("li",[this._v("多次总结，使用一款产品，第一件事就是找到文档，文档实在晦涩难懂的情况，那么可能有翻译版或者国内版，毕竟官方的才是最权威的")]),this._v(" "),e("li",[this._v("其次是每个人用起来遇到的环境可能不一样，遇到的问题也就不一样，但所有的解决思路中，查看日志这一条是我觉得始终应该第一考虑的，它很明白告诉你，出错了，出了什么错，可能还有出错的具体位置以及建议解决方案")]),this._v(" "),e("li",[this._v("end")])])}],!1,null,null,null);e.default=a.exports}}]);